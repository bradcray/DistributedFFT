#include<stdio.h>
#include<math.h>
#include <myfft.h>

void checksum_verify (int d1, int d2, int d3, int nt, myComplex_t *sums)
{
  /*--------------------------------------------------------------------
    c-------------------------------------------------------------------*/
  int i;
  double err, epsilon;
  int known_class = 0;
  int verified;
  /*--------------------------------------------------------------------
    c   Sample size reference checksums
    c-------------------------------------------------------------------*/

  /*--------------------------------------------------------------------
    c   Class S size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_s[6 ] =
  {
   5.546087004964e+02,
   5.546385409189e+02,
   5.546148406171e+02,
   5.545423607415e+02,
   5.544255039624e+02,
   5.542683411902e+02};
  double vdata_imag_s[6 ] =
  {
   4.845363331978e+02,
   4.865304269511e+02,
   4.883910722336e+02,
   4.901273169046e+02,
   4.917475857993e+02,
   4.932597244941e+02};
  /*--------------------------------------------------------------------
    c   Class W size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_w[6 ] =
  {
   5.673612178944e+02,
   5.631436885271e+02,
   5.594024089970e+02,
   5.560698047020e+02,
   5.530898991250e+02,
   5.504159734538e+02};
  double vdata_imag_w[6 ] =
  {
   5.293246849175e+02,
   5.282149986629e+02,
   5.270996558037e+02,
   5.260027904925e+02,
   5.249400845633e+02,
   5.239212247086e+02};
  /*--------------------------------------------------------------------
    c   Class A size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_a[6] =
  {
   5.046735008193e+02,
   5.059412319734e+02,
   5.069376896287e+02,
   5.077892868474e+02,
   5.085233095391e+02,
   5.091487099959e+02};
  double vdata_imag_a[6 ] =
  {
   5.114047905510e+02,
   5.098809666433e+02,
   5.098144042213e+02,
   5.101336130759e+02,
   5.104914655194e+02,
   5.107917842803e+02};
  /*--------------------------------------------------------------------
    c   Class B size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_b[20 ] =
  {
   5.177643571579e+02,
   5.154521291263e+02,
   5.146409228649e+02,
   5.142378756213e+02,
   5.139626667737e+02,
   5.137423460082e+02,
   5.135547056878e+02,
   5.133910925466e+02,
   5.132470705390e+02,
   5.131197729984e+02,
   5.130070319283e+02,
   5.129070537032e+02,
   5.128182883502e+02,
   5.127393733383e+02,
   5.126691062020e+02,
   5.126064276004e+02,
   5.125504076570e+02,
   5.125002331720e+02,
   5.124551951846e+02,
   5.124146770029e+02};
  double vdata_imag_b[20 ] =
  {
   5.077803458597e+02,
   5.088249431599e+02,
   5.096208912659e+02,
   5.101023387619e+02,
   5.103976610617e+02,
   5.105948019802e+02,
   5.107404165783e+02,
   5.108576573661e+02,
   5.109577278523e+02,
   5.110460304483e+02,
   5.111252433800e+02,
   5.111968077718e+02,
   5.112616233064e+02,
   5.113203605551e+02,
   5.113735928093e+02,
   5.114218460548e+02,
   5.114656139760e+02,
   5.115053595966e+02,
   5.115415130407e+02,
   5.115744692211e+02};
  /*--------------------------------------------------------------------
    c   Class C size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_c[20 ] =
  {
   5.195078707457e+02,
   5.155422171134e+02,
   5.144678022222e+02,
   5.140150594328e+02,
   5.137550426810e+02,
   5.135811056728e+02,
   5.134569343165e+02,
   5.133651975661e+02,
   5.132955192805e+02,
   5.132410471738e+02,
   5.131971141679e+02,
   5.131605205716e+02,
   5.131290734194e+02,
   5.131012720314e+02,
   5.130760908195e+02,
   5.130528295923e+02,
   5.130310107773e+02,
   5.130103090133e+02,
   5.129905029333e+02,
   5.129714421109e+02};
  double vdata_imag_c[20 ] =
  {
   5.149019699238e+02,
   5.127578201997e+02,
   5.122251847514e+02,
   5.121090289018e+02,
   5.121143685824e+02,
   5.121496764568e+02,
   5.121870921893e+02,
   5.122193250322e+02,
   5.122454735794e+02,
   5.122663649603e+02,
   5.122830879827e+02,
   5.122965869718e+02,
   5.123075927445e+02,
   5.123166486553e+02,
   5.123241541685e+02,
   5.123304037599e+02,
   5.123356167976e+02,
   5.123399592211e+02,
   5.123435588985e+02,
   5.123465164008e+02};
  /*--------------------------------------------------------------------
    c   Class D size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d[25] =
  {
   5.122230065252e+02,
   5.120463975765e+02,
   5.119865766760e+02,
   5.119518799488e+02,
   5.119269088223e+02,
   5.119082416858e+02,
   5.118943814638e+02,
   5.118842385057e+02,
   5.118769435632e+02,
   5.118718203448e+02,
   5.118683569061e+02,
   5.118661708593e+02,
   5.118649768950e+02,
   5.118645605626e+02,
   5.118647586618e+02,
   5.118654451572e+02,
   5.118665212451e+02,
   5.118679083821e+02,
   5.118695433664e+02,
   5.118713748264e+02,
   5.118733606701e+02,
   5.118754661974e+02,
   5.118776626738e+02,
   5.118799262314e+02,
   5.118822370068e+02};
  double vdata_imag_d[25] =
  {
   5.118534037109e+02,
   5.117061181082e+02,
   5.117096364601e+02,
   5.117373863950e+02,
   5.117680347632e+02,
   5.117967875532e+02,
   5.118225281841e+02,
   5.118451629348e+02,
   5.118649119387e+02,
   5.118820803844e+02,
   5.118969781011e+02,
   5.119098918835e+02,
   5.119210777066e+02,
   5.119307604484e+02,
   5.119391362671e+02,
   5.119463757241e+02,
   5.119526269238e+02,
   5.119580184108e+02,
   5.119626617538e+02,
   5.119666538138e+02,
   5.119700787219e+02,
   5.119730095953e+02,
   5.119755100241e+02,
   5.119776353561e+02,
   5.119794338060e+02
  };

  /* >>BEGIN LOCALLY ADDED PROBLEM SIZES<< */
  /*--------------------------------------------------------------------
    c   Class DE (aka 'E') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_de[25 ] =
  {
   5.102470850750e+02,
   5.111801643633e+02,
   5.114529368783e+02,
   5.115874141521e+02,
   5.116733942554e+02,
   5.117336386185e+02,
   5.117775644375e+02,
   5.118104266630e+02,
   5.118354894731e+02,
   5.118548730892e+02,
   5.118700062447e+02,
   5.118818892917e+02,
   5.118912489221e+02,
   5.118986299003e+02,
   5.119044506456e+02,
   5.119090381403e+02,
   5.119126508696e+02,
   5.119154946408e+02,
   5.119177339856e+02,
   5.119195006873e+02,
   5.119209003355e+02,
   5.119220174640e+02,
   5.119229196316e+02,
   5.119236606900e+02,
   5.119242834152e+02};
  double vdata_imag_de[25 ] =
  {
   5.119971126300e+02,
   5.120441533658e+02,
   5.120543039839e+02,
   5.120470675975e+02,
   5.120404948200e+02,
   5.120391743436e+02,
   5.120422665025e+02,
   5.120480903816e+02,
   5.120553372322e+02,
   5.120631836263e+02,
   5.120711616558e+02,
   5.120790231758e+02,
   5.120866442874e+02,
   5.120939669125e+02,
   5.121009658306e+02,
   5.121076312560e+02,
   5.121139602516e+02,
   5.121199528767e+02,
   5.121256107101e+02,
   5.121309364595e+02,
   5.121359339882e+02,
   5.121406084387e+02,
   5.121449663158e+02,
   5.121490154884e+02,
   5.121527651095e+02};
  /*--------------------------------------------------------------------
    c   Class DQ (aka 'Q') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_dq[25 ] =
  {
   5.100021384457e+02,
   5.107077402572e+02,
   5.111258943980e+02,
   5.113745426197e+02,
   5.115371222930e+02,
   5.116520247117e+02,
   5.117383844125e+02,
   5.118063403327e+02,
   5.118615759864e+02,
   5.119074780581e+02,
   5.119461989515e+02,
   5.119791954308e+02,
   5.120075109022e+02,
   5.120319290468e+02,
   5.120530609872e+02,
   5.120713970144e+02,
   5.120873387758e+02,
   5.121012203067e+02,
   5.121133224506e+02,
   5.121238832012e+02,
   5.121331054187e+02,
   5.121411627798e+02,
   5.121482044900e+02,
   5.121543590893e+02,
   5.121597375743e+02};
  double vdata_imag_dq[25 ] =
  {
   5.102354099485e+02,
   5.110372633662e+02,
   5.113134002360e+02,
   5.114685939810e+02,
   5.115707374808e+02,
   5.116449517887e+02,
   5.117031961854e+02,
   5.117514932905e+02,
   5.117929844143e+02,
   5.118293855692e+02,
   5.118616995522e+02,
   5.118905677614e+02,
   5.119164444681e+02,
   5.119396827497e+02,
   5.119605764397e+02,
   5.119793803911e+02,
   5.119963202810e+02,
   5.120115975573e+02,
   5.120253922561e+02,
   5.120378649681e+02,
   5.120491585092e+02,
   5.120593995031e+02,
   5.120686999316e+02,
   5.120771586436e+02,
   5.120848627974e+02};
  /*--------------------------------------------------------------------
    c   Class DH (aka 'H') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_dh[25 ] =
  {
   5.116577823033e+02,
   5.115693002110e+02,
   5.116594781204e+02,
   5.117318626123e+02,
   5.117854293358e+02,
   5.118280856712e+02,
   5.118643536980e+02,
   5.118962169291e+02,
   5.119245069338e+02,
   5.119496314520e+02,
   5.119718715589e+02,
   5.119914819920e+02,
   5.120087150402e+02,
   5.120238193816e+02,
   5.120370334009e+02,
   5.120485793930e+02,
   5.120586600978e+02,
   5.120674573643e+02,
   5.120751323386e+02,
   5.120818266012e+02,
   5.120876638105e+02,
   5.120927515566e+02,
   5.120971832335e+02,
   5.121010398212e+02,
   5.121043915204e+02};
  double vdata_imag_dh[25 ] =
  {
   5.102474711843e+02,
   5.108297427588e+02,
   5.111677372126e+02,
   5.113819725173e+02,
   5.115331411069e+02,
   5.116469520295e+02,
   5.117359230707e+02,
   5.118071547100e+02,
   5.118651589280e+02,
   5.119130181970e+02,
   5.119529356180e+02,
   5.119865337476e+02,
   5.120150341749e+02,
   5.120393729642e+02,
   5.120602782105e+02,
   5.120783237496e+02,
   5.120939672150e+02,
   5.121075775100e+02,
   5.121194549542e+02,
   5.121298462677e+02,
   5.121389558515e+02,
   5.121469543779e+02,
   5.121539853960e+02,
   5.121601704602e+02,
   5.121656131470e+02};
  /*--------------------------------------------------------------------
    c   Class D2 (aka '2') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d2[25 ] =
  {
   5.114766506910e+02,
   5.117572103981e+02,
   5.118274373411e+02,
   5.118503214914e+02,
   5.118596370720e+02,
   5.118641012719e+02,
   5.118666865831e+02,
   5.118686743501e+02,
   5.118706640935e+02,
   5.118729169814e+02,
   5.118755155026e+02,
   5.118784506047e+02,
   5.118816710297e+02,
   5.118851106639e+02,
   5.118887029092e+02,
   5.118923875445e+02,
   5.118961133907e+02,
   5.118998387445e+02,
   5.119035307186e+02,
   5.119071641239e+02,
   5.119107202344e+02,
   5.119141856074e+02,
   5.119175510333e+02,
   5.119208106413e+02,
   5.119239611567e+02};
  double vdata_imag_d2[25 ] =
  {
   5.113117018172e+02,
   5.116926059987e+02,
   5.118183060891e+02,
   5.118829234697e+02,
   5.119257661946e+02,
   5.119574781018e+02,
   5.119820353756e+02,
   5.120014106533e+02,
   5.120168118849e+02,
   5.120290824810e+02,
   5.120388549068e+02,
   5.120466208496e+02,
   5.120527694930e+02,
   5.120576118067e+02,
   5.120613976305e+02,
   5.120643284161e+02,
   5.120665670256e+02,
   5.120682453915e+02,
   5.120694705628e+02,
   5.120703295069e+02,
   5.120708929444e+02,
   5.120712184238e+02,
   5.120713527940e+02,
   5.120713342013e+02,
   5.120711937033e+02};
  /*--------------------------------------------------------------------
    c   Class D4 (aka '4') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d4[25 ] =
  {
   5.120384928179e+02,
   5.120520687883e+02,
   5.120361273442e+02,
   5.120176978967e+02,
   5.120017706707e+02,
   5.119897998728e+02,
   5.119816582775e+02,
   5.119766967155e+02,
   5.119741911747e+02,
   5.119735002745e+02,
   5.119741046144e+02,
   5.119756022021e+02,
   5.119776901386e+02,
   5.119801443301e+02,
   5.119828014035e+02,
   5.119855439215e+02,
   5.119882888001e+02,
   5.119909784456e+02,
   5.119935740600e+02,
   5.119960506237e+02,
   5.119983931506e+02,
   5.120005939015e+02,
   5.120026503139e+02,
   5.120045634680e+02,
   5.120063369518e+02};
  double vdata_imag_d4[25 ] =
  {
   5.118265970021e+02,
   5.120494128526e+02,
   5.120947516817e+02,
   5.120976736306e+02,
   5.120923837605e+02,
   5.120862628959e+02,
   5.120806058849e+02,
   5.120754480129e+02,
   5.120706550555e+02,
   5.120661324547e+02,
   5.120618376076e+02,
   5.120577594153e+02,
   5.120539005956e+02,
   5.120502672367e+02,
   5.120468637623e+02,
   5.120436910811e+02,
   5.120407463711e+02,
   5.120380235889e+02,
   5.120355142184e+02,
   5.120332080205e+02,
   5.120310936866e+02,
   5.120291593640e+02,
   5.120273930563e+02,
   5.120257829164e+02,
   5.120243174511e+02};
  /*--------------------------------------------------------------------
    c   Class D8 (aka '8') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d8[25 ] =
  {
   5.121601045346e+02,
   5.120905403678e+02,
   5.120623229306e+02,
   5.120438418997e+02,
   5.120311521872e+02,
   5.120226088809e+02,
   5.120169296534e+02,
   5.120131225172e+02,
   5.120104767108e+02,
   5.120085127969e+02,
   5.120069224127e+02,
   5.120055158164e+02,
   5.120041820159e+02,
   5.120028605402e+02,
   5.120015223011e+02,
   5.120001570023e+02,
   5.119987650555e+02,
   5.119973525091e+02,
   5.119959279472e+02,
   5.119945006558e+02,
   5.119930795911e+02,
   5.119916728462e+02,
   5.119902874185e+02,
   5.119889291565e+02,
   5.119876028049e+02};
  double vdata_imag_d8[25 ] =
  {
   5.117395998266e+02,
   5.118614716182e+02,
   5.119074203747e+02,
   5.119345900732e+02,
   5.119551325550e+02,
   5.119720179919e+02,
   5.119861371665e+02,
   5.119979364401e+02,
   5.120077674092e+02,
   5.120159443121e+02,
   5.120227453670e+02,
   5.120284096041e+02,
   5.120331373793e+02,
   5.120370938679e+02,
   5.120404138830e+02,
   5.120432068837e+02,
   5.120455615860e+02,
   5.120475499442e+02,
   5.120492304629e+02,
   5.120506508902e+02,
   5.120518503782e+02,
   5.120528612016e+02,
   5.120537101195e+02,
   5.120544194514e+02,
   5.120550079284e+02};
  /*--------------------------------------------------------------------
    c   Class D16 (aka 'X') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d16[25 ] =
  {
   5.119699634554e+02,
   5.118834961590e+02,
   5.118785710565e+02,
   5.118905749272e+02,
   5.119050333722e+02,
   5.119180522418e+02,
   5.119288293237e+02,
   5.119374706152e+02,
   5.119443091217e+02,
   5.119496926075e+02,
   5.119539233188e+02,
   5.119572474962e+02,
   5.119598603844e+02,
   5.119619150014e+02,
   5.119635307527e+02,
   5.119648007608e+02,
   5.119657977564e+02,
   5.119665786914e+02,
   5.119671883088e+02,
   5.119676618883e+02,
   5.119680273555e+02,
   5.119683069030e+02,
   5.119685182364e+02,
   5.119686755359e+02,
   5.119687901999e+02};
  double vdata_imag_d16[25 ] =
  {
   5.120610265364e+02,
   5.121247883285e+02,
   5.121210747682e+02,
   5.121080250520e+02,
   5.120947903089e+02,
   5.120828609933e+02,
   5.120722870877e+02,
   5.120628821381e+02,
   5.120544699116e+02,
   5.120469174530e+02,
   5.120401252293e+02,
   5.120340144079e+02,
   5.120285184253e+02,
   5.120235784144e+02,
   5.120191409979e+02,
   5.120151573111e+02,
   5.120115825802e+02,
   5.120083759094e+02,
   5.120055001137e+02,
   5.120029215379e+02,
   5.120006098447e+02,
   5.119985377789e+02,
   5.119966809153e+02,
   5.119950174046e+02,
   5.119935277244e+02};
  /*--------------------------------------------------------------------
    c   Class D32 (aka 'Y') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d32[25 ] =
  {
   5.119307845303e+02,
   5.119024617821e+02,
   5.119166239349e+02,
   5.119327096126e+02,
   5.119452319127e+02,
   5.119540638814e+02,
   5.119600365351e+02,
   5.119639768866e+02,
   5.119665216566e+02,
   5.119681216993e+02,
   5.119690853078e+02,
   5.119696202447e+02,
   5.119698659381e+02,
   5.119699161227e+02,
   5.119698341650e+02,
   5.119696632514e+02,
   5.119694331132e+02,
   5.119691644565e+02,
   5.119688718864e+02,
   5.119685658439e+02,
   5.119682538958e+02,
   5.119679415988e+02,
   5.119676330820e+02,
   5.119673314443e+02,
   5.119670390267e+02};
  double vdata_imag_d32[25 ] =
  {
   5.122436806399e+02,
   5.122599619784e+02,
   5.122279967148e+02,
   5.121978295154e+02,
   5.121730265125e+02,
   5.121526032534e+02,
   5.121355006884e+02,
   5.121209682700e+02,
   5.121084861475e+02,
   5.120976789992e+02,
   5.120882624504e+02,
   5.120800126208e+02,
   5.120727486565e+02,
   5.120663221450e+02,
   5.120606101800e+02,
   5.120555104399e+02,
   5.120509374558e+02,
   5.120468196553e+02,
   5.120430969604e+02,
   5.120397188101e+02,
   5.120366425266e+02,
   5.120338319644e+02,
   5.120312563946e+02,
   5.120288895846e+02,
   5.120267090415e+02};
  /*--------------------------------------------------------------------
    c   Class D64 (aka 'Z') size reference checksums
    c-------------------------------------------------------------------*/
  double vdata_real_d64[25 ] =
  {
   5.119892866928e+02,
   5.119560157487e+02,
   5.119437960123e+02,
   5.119395628845e+02,
   5.119390371879e+02,
   5.119405091840e+02,
   5.119430444528e+02,
   5.119460702242e+02,
   5.119492377036e+02,
   5.119523446268e+02,
   5.119552825361e+02,
   5.119580008777e+02,
   5.119604834177e+02,
   5.119627332821e+02,
   5.119647637538e+02,
   5.119665927740e+02,
   5.119682397643e+02,
   5.119697238718e+02,
   5.119710630664e+02,
   5.119722737384e+02,
   5.119733705802e+02,
   5.119743666226e+02,
   5.119752733481e+02,
   5.119761008382e+02,
   5.119768579280e+02};
  double vdata_imag_d64[25 ] =
  {
   5.121457822747e+02,
   5.121009044434e+02,
   5.120761074285e+02,
   5.120614320496e+02,
   5.120514085624e+02,
   5.120438117102e+02,
   5.120376348915e+02,
   5.120323831062e+02,
   5.120277980818e+02,
   5.120237368268e+02,
   5.120201137845e+02,
   5.120168723492e+02,
   5.120139707209e+02,
   5.120113749334e+02,
   5.120090554887e+02,
   5.120069857863e+02,
   5.120051414260e+02,
   5.120034999132e+02,
   5.120020405355e+02,
   5.120007442976e+02,
   5.119995938652e+02,
   5.119985735001e+02,
   5.119976689792e+02,
   5.119968675026e+02,
   5.119961575929e+02};
  /* >>END LOCALLY ADDED PROBLEM SIZES<< */
    
  epsilon = 1.0e-12;
  verified = 1;
  
  /* CLASS S*/
  if (d1 == 64 &&
      d2 == 64 &&
      d3 == 64 &&
      nt == 6)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_s[i]) / vdata_real_s[i];
          if (fabs (err) > epsilon)
            {
	      verified = 0;
	      break;
            }
          err = (sums[i].imag - vdata_imag_s[i]) / vdata_imag_s[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS W*/
  else if (d1 == 128 &&
           d2 == 128 &&
           d3 == 32 &&
           nt == 6)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_w[i]) / vdata_real_w[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_w[i]) / vdata_imag_w[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*Class A*/
  else if (d1 == 256 &&
           d2 == 256 &&
           d3 == 128 &&
           nt == 6)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_a[i]) / vdata_real_a[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_a[i]) / vdata_imag_a[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS B*/
  else if (d1 == 512 &&
           d2 == 256 &&
           d3 == 256 &&
           nt == 20)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_b[i]) / vdata_real_b[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_b[i]) / vdata_imag_b[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS C*/
  else if (d1 == 512 &&
           d2 == 512 &&
           d3 == 512 &&
           nt == 20)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_c[i]) / vdata_real_c[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_c[i]) / vdata_imag_c[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D*/
  else if (d1 == 2048 &&
           d2 == 1024 &&
           d3 == 1024 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d[i]) / vdata_real_d[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d[i]) / vdata_imag_d[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /* >>BEGIN LOCALLY ADDED PROBLEM SIZES<< */
  /*CLASS DE*/
  else if (d1 == 1024 &&
           d2 == 512 &&
           d3 == 512 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_de[i]) / vdata_real_de[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_de[i]) / vdata_imag_de[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS DQ*/
  else if (d1 == 1024 &&
           d2 == 1024 &&
           d3 == 512 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_dq[i]) / vdata_real_dq[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_dq[i]) / vdata_imag_dq[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS DH*/
  else if (d1 == 1024 &&
           d2 == 1024 &&
           d3 == 1024 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_dh[i]) / vdata_real_dh[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_dh[i]) / vdata_imag_dh[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D2*/
  else if (d1 == 2048 &&
           d2 == 2048 &&
           d3 == 1024 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d2[i]) / vdata_real_d2[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d2[i]) / vdata_imag_d2[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D4*/
  else if (d1 == 2048 &&
           d2 == 2048 &&
           d3 == 2048 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d4[i]) / vdata_real_d4[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d4[i]) / vdata_imag_d4[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D8*/
  else if (d1 == 4096 &&
           d2 == 2048 &&
           d3 == 2048 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d8[i]) / vdata_real_d8[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d8[i]) / vdata_imag_d8[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D16*/
  else if (d1 == 4096 &&
           d2 == 4096 &&
           d3 == 2048 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d16[i]) / vdata_real_d16[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d16[i]) / vdata_imag_d16[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D32*/
  else if (d1 == 4096 &&
           d2 == 4096 &&
           d3 == 4096 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d32[i]) / vdata_real_d32[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d32[i]) / vdata_imag_d32[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /*CLASS D64*/
  else if (d1 == 8192 &&
           d2 == 4096 &&
           d3 == 4096 &&
           nt == 25)
    {
      known_class = 1;
      for (i = 0; i < nt; i++)
        {
          err = (sums[i].real - vdata_real_d64[i]) / vdata_real_d64[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
          err = (sums[i].imag - vdata_imag_d64[i]) / vdata_imag_d64[i];
          if (fabs (err) > epsilon)
            {
              verified = 0;
              break;
            }
        }
    }
  /* >>END LOCALLY ADDED PROBLEM SIZES<< */

  if (known_class && (verified))
    {
      printf (" 0>\t\tResult verification successful\n");
    }
  else
    {
      if(known_class == 0) 
	printf (" 0>\t\tResult verification failed: UNKNOWN CLASS\n");
      else 
	printf (" 0>\t\tResult verification failed: CHECKSUMS DIDN'T MATCH\n"); 
    }
}
